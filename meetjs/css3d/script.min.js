/**
 * So you are curious how it was done?
 *
 * It was quickly prototyped by trial and error, so code is full of not-so-very-best practices.
 * That's why you get uglified version here -- I don't want to make it too easy to learn from this crappy code ;)
 * And I don't want to make your life easier ;)
 * Anyway, if you really want to decypher it you will do it anyway, wouldn't you?
 *
 * It took me around ten evenings and one angry wife to code it, so appreciate ;)
 *
 *
 * Copyright 2011 Bartek Szopka
 *
 * P.S.
 * If you'd like to see it available as 'presentantion framework', drop me a line on twitter @bartaz.
 * I will probably do it anyway, but it will motivate me to do it faster ;)
 */
$(function(){function a(a){var b=a.data();$(".step.active").removeClass("active"),a.addClass("active"),$("#view").get(0).className="step-"+a.attr("id"),a={rotate:-parseInt(b.rotate,10),scale:1/parseFloat(b.scale)},a.x=-b.x,a.y=-b.y,d.css({"-webkit-transform":" scale("+a.scale+") ","-webkit-transition-delay":a.scale>e.scale?"300ms":"0"}).children(".rotate").css({"-webkit-transform":" rotate("+a.rotate+"deg) ","-webkit-transition":"","-webkit-transition-delay":a.scale>e.scale?"0":"300ms"}).children(".translate").css({"-webkit-transform":" translate("+a.x+"px,"+a.y+"px) ","-webkit-transition":"","-webkit-transition-delay":a.scale>e.scale?"0":"300ms"}),$.extend(e,a)}function b(a){var b=a.closest(".code").clone().find(".disabled").remove().end(),c=b.text().trim().replace(/\n/ig," ");a.closest(".step").find(".target "+(b.data("selector")||"")).css(b.data("property"),c||"")}function c(a){clearTimeout(f),f=setTimeout(function(){b(a)},50)}var d=$("#canvas").data("x","0").data("y","0").data("rotate","0").data("scale","1"),e=d.data();$(".step").each(function(){var a=$(this).data();$(this).css({"-webkit-transform":"translate(-50%,-50%)"+(" translate("+a.x+"px,"+a.y+"px) ")+(" rotate("+a.rotate+"deg) ")+(" scale("+a.scale+") ")})}),$(document).on("click",".step",function(){a($(this))}),$(document).on("keydown",function(b){if(32==b.keyCode||37<=b.keyCode&&40>=b.keyCode){var c=null;switch(b.keyCode){case 37:case 38:c=$(".step.active").prev(),c.length||(c=$(".step:last"));break;case 32:case 39:case 40:c=$(".step.active").next(),c.length||(c=$(".step:first"))}a(c),b.preventDefault()}});var f=null;$(document).on("dblclick",".switch",function(){return $(this).toggleClass("disabled"),c($(this)),!1}).on("dblclick",".flip",function(a){$(a.target).is(".snippet")&&$(this).toggleClass("back")}),$(".slider input[type=range]").on("change",function(){var a=$(this).val(),b=$(this).data("divider")||1,a=a/b;parseFloat(a),a=""+a.toFixed(1),1==b&&(a=parseFloat(a)),$(this).closest("label").find(".val").text(a),c($(this))});var g=$(document),h=$("#perspective").find(".scene"),i=h.find(".cross"),j=i.height()/2,k=i.width()/2;h.on("mousedown",function(a){var b=i.position();return g.on("mousemove.drag",function(c){var d=b.left+c.pageX-a.pageX,c=b.top+c.pageY-a.pageY;return i.css({left:d,top:c}),h.css("-webkit-perspective-origin",d+k+"px "+(c+j)+"px"),$("code .origin .value").text(~~(d+k)+"px "+~~(c+j)+"px"),!1}),!1}),g.on("mouseup",function(){g.off("mousemove.drag")}),$("#transforms3d-box .cube").css("-webkit-transform-style","preserve-3d"),$(".step:first").click(),$(".step:has(.target) .code").each(function(){b($(this).children().eq(0))})})

